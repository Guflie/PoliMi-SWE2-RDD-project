\subsection{Product perspective}

\input{RASD/Section2/scenarios.tex}
\pagebreak

\subsubsection{Domain Class Diagram}

    \begin{figure}[h!]
        \centering
        \includegraphics[width=1\textwidth]{RASD/domain class diagram/domain_class_diagram_v3.pdf}
        \caption{Domain Class Diagram of the BBP system}
        \label{fig:domain_model}
    \end{figure}


    Figure \ref{fig:domain_model} shows the domain class diagram. The following points outline some choices made while modeling the domain:
   
    \begin{itemize}
        \item \textbf{User \& Trip generalizations:} two superclasses were introduced to standardize and encapsulate the core functionalities shared by a
        ll elements. By contrast, their specialization classes are responsible for capturing and highlighting the specific, differentiated relationships that 
        these elements have with the rest of the domain components.

        \item \textbf{Publishable Info abstraction:} the introduction of this abstraction was motivated by the intent to make the defined set of publishable 
        information highly adaptable, in order to maximize flexibility for future extensions about publishable informations.
 
    \end{itemize}

\pagebreak

\subsubsection{State Diagrams}

    \textbf{Activity Lifecycle} 

    \begin{figure}[H]
        \centering
        \includegraphics[width=0.9\textwidth]{RASD/state diagrams/activity_state_diagram.pdf}
        \caption{State Diagram of the Lifecycle of a Trip in the BBP System}
        \label{fig:trip_lifecycle}
    \end{figure}

    % TODO: update this
    The diagram in Figure \ref{fig:trip_lifecycle} models the complete lifecycle of a \texttt{Trip}, from its inception to its final storage or 
    discard. The process begins in the initial \texttt{Route\_Definition} state, which represents the hub where a new route can be defined or an 
    existing one can be used. The fundamental transition to data acquisition occurs only if the \texttt{[if RegisteredUser]} guard condition is 
    satisfied, ensuring that only authenticated users can initiate tracking, based on the system's contribution requirements. Once in the 
    \texttt{Data\_Logging} state, the system actively logs raw sensor data (GPS, accelerometer) if in automatic mode. This state offers flexibility,
    allowing data acquisition to be paused and resumed via transitions. The system manages three distinct transitions when recording is stopped, 
    resulting in separate processing paths:

    \begin{itemize}
        \item \textbf{Stop in manual mode}: This transition allows the user to actively add non-sensor data to the route.
        \item \textbf{Stop in automated mode}: Indicates that the route has ended, starting the automatic processing cycle.
        \item \textbf{Stop without data}: If the user does not wish to add any data, they go directly to the confirmation to save or delete the 
        collected data (if collected).
    \end{itemize}

    The automated processing cycle begins with \texttt{Enrichment\_WeatherInfo}, where the system enriches the trip with weather data retrieved 
    from external services. Once enrichment is complete, the flow moves to \texttt{Awaiting\_Confirmation}. This state is crucial for data quality:
    here, the user must decide whether to validate the anomalies detected by the sensors (e.g., potholes) or discard them. The cycle closes 
    by returning to the \texttt{Route\_Definition} state or definitively exiting the system, demonstrating how data only goes from ephemeral to 
    persistent information through a rigorous validation process.

    \textbf{Issue Lifecycle} 

    \begin{figure}[H]
        \centering
        \includegraphics[width=0.9\textwidth]{RASD/state diagrams/issue_state_diagram.pdf}
        \caption{Data lifecycle state diagram in BBP system}
        \label{fig:data_lifecycle}
    \end{figure}

    % TODO: updates
    The diagram in Figure \ref{fig:data_lifecycle} models the complete data lifecycle, from its origin to its final state. The process rigorously 
    distinguishes data based on its source to direct it to the correct validation path. The flow forks immediately from the initial state:

    \begin{itemize}
        \item \textbf{Manual Path:} The user generates a \texttt{Manual report} that transitions to the \texttt{Manual\_Submission} state. 
        The data, being the result of an explicit action, is initially saved and can be published if the user wishes.
        \item \textbf{Automatic Path:} The data passively detected by the sensors transitions to the \texttt{Dected\_Raw} state. This raw data must
        pass through the \texttt{Awaiting\_Confirmation} state at the end of its journey.
    \end{itemize}

    The pending confirmation state is the critical checkpoint: the user is responsible for validating the discovery to allow it to move to 
    \texttt{Publishable}, or discarding it, moving it to \texttt{Discarded}. Only data in the \texttt{Publishable} state is integrated and can 
    influence the \texttt{Path Score}. The cycle ends with final publication or discard.
\pagebreak
